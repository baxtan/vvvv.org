import{ae as V,r as l,a5 as x,af as F,a4 as P,b as m,ag as S,a9 as R,a8 as p,ah as U,ai as q,a2 as o,a1 as i,aj as n,a3 as t,a6 as d,ab as O,ak as g,al as z}from"./app.js";import{_ as G,a as T}from"./HireView.js";import{_ as D}from"./SocialView.js";import{_ as I}from"./Location.js";import"./Space.js";import"./LocationOutline.js";const K={key:0,class:"userView"},H={class:"row"},J={class:"col-12 col-md-6 col-lg-3 text-center mb-sm-4"},Q={class:"my-3"},W={key:0,class:"text-muted mb-1"},X={class:"mb-1"},Y=["href"],Z={key:0,class:"border-top pt-2 mt-4"},ee=["href"],ae={class:"col-12 col-md-6 col-lg-9"},te={key:1,class:"mb-4 statement"},se={key:2},le={class:"card"},w=120,me={__name:"UserView",setup(oe){const N=V();q();const y=N.params.username,e=l(null),c=l(null),_=l(null),b=l(null),h=l(!1),r=l(null),k=l("Show More"),v=l(null),f=l(!1),j=["contact","website","github","nuget","mastodon","pixelfed"],B=`?withoutEnlargement=true&quality=90&fit=cover&width=${w}&height=${w}`,C=`${x.GET_USERS}?filter[username][_eq]=${y}
            &fields=*,related.hire.*,related.hire.availableFor.AvailableFor_Options_id.value,related.social.*`,E=`${x.GET_COMPANIES}?filter[owner][username][_eq]=${y}&fields=name`;F(async()=>{h.value=!0;try{let s=await fetch(C),a=await s.json();if(a.data.length==0)throw"Can't find a profile for this user";const u=a.data[0];e.value=u,b.value=e.value.userpic?`${P(e.value.userpic)}${B}`:null,c.value=u.related[0]?.hire,_.value=u.related[0]?.social,v.value=e.value.statement,M(),s=await fetch(E),a=await s.json(),a.data.length>0&&(r.value=a.data[0].name)}catch(s){console.error(s)}finally{h.value=!1}});const L=m(()=>({city:e.value.location_city,country:e.value.location_country})),$=m(()=>{const s=[e.value.name,e.value.surname].filter(Boolean).join(" ");return s||null});m(()=>(console.log(e.value.statement.length),e.value.statement.length>200));const A=m(()=>"https://forum.vvvv.org/u/"+e.value.username+"/summary"),M=()=>{f.value?(k.value="Show Less",v.value=e.value.statement):(k.value="Show More",v.value=e.value.statement.slice(0,100)),f.value=!f.value};return(s,a)=>(o(),S(p(U),{show:h.value},{default:R(()=>[e.value?(o(),i("div",K,[t("div",H,[t("div",J,[d(p(O),{objectFit:"contain",round:"",size:w,src:b.value},null,8,["src"]),t("div",Q,[t("h5",null,g(e.value.username),1),$.value?(o(),i("p",W,g($.value),1)):n("",!0)]),d(I,{location:L.value},null,8,["location"]),t("p",X,[t("a",{href:A.value},"Forum Profile",8,Y)]),r.value?(o(),i("div",Z,[a[1]||(a[1]=t("div",null,"Owner of",-1)),t("a",{href:"/business/"+r.value,onClick:a[0]||(a[0]=u=>p(z)(r.value,u))},g(r.value),9,ee)])):n("",!0)]),t("div",ae,[_.value?(o(),S(D,{key:0,class:"text-left mb-4",social:_.value,order:j},null,8,["social"])):n("",!0),v.value?(o(),i("div",te,[d(G,{text:e.value.statement,maxLength:255,clippedLength:100},null,8,["text"])])):n("",!0),c.value&&c.value.available?(o(),i("div",se,[a[2]||(a[2]=t("h4",{class:"h4"},"Available for hire",-1)),t("div",le,[d(T,{data:c.value},null,8,["data"])])])):n("",!0)])])])):n("",!0)]),_:1},8,["show"]))}};export{me as default};
