import{a5 as b,b1 as R,r as _,af as C,ag as m,a2 as t,a9 as p,a1 as o,ah as n,a3 as a,ai as u,H as L,aU as I,bM as f,a6 as g,a8 as r,ak as $,a4 as N,ae as U,aX as F,e as w,ad as M,bN as T,bO as x,aa as V,aj as Q,ac as G,al as H}from"./app.js";import{_ as O,L as Z,a as q}from"./Location.js";const D=b.BASEURL+"items/Company?fields=*&sort=name&meta=filter_count",j="withoutEnlargement=true&fit=inside&height=50&quality=90&format=auto";function J(l){return l?`${b.ASSETS}${l}?${j}`:null}async function W(l,e,i){try{const s=await(await fetch(D)).json();l.value=s.data,l.value.forEach(d=>{d.logo=J(d.logo)}),e.value=s.meta.filter_count,e.value>0&&i("setCount",e.value)}catch{console.log("error")}}const K="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFeXl5AAAAa7+IbgAAAFhJREFUeNrswQEBAAAAgJD+r+4ICgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFgAAQYAAQ8AAbQIco0AAAAASUVORK5CYII=",P={key:0,class:"businesses"},X={class:"row"},Y=["onClick"],z={class:"company"},ee={class:"logo"},te=["src"],ae={class:"name"},se="col-12 col-sm-6 col-md-4 col-lg-3 my-2",oe={__name:"BusinessList",emits:["setCount"],setup(l,{emit:e}){const i=e,c=R(),s=_(null),d=_(0),v=_(!0);C(async()=>{v.value=!0,W(s,d,i),v.value=!1});const A=y=>{c.push(`/user/businesses?company=${y}`)};return(y,ke)=>(t(),m(r($),{show:v.value},{default:p(()=>[v.value?n("",!0):(t(),o("div",P,[a("p",null,"A list of "+u(d.value)+" businesses that use vvvv.",1),a("div",X,[(t(!0),o(L,null,I(s.value,({name:k,description:Ce,logo:B,location_city:S,location_country:E})=>(t(),o("div",{"track-by":"name",class:f(se)},[a("div",{class:"companyCard p-3",onClick:$e=>A(k)},[a("div",z,[a("div",ee,[y.profilepic!==null?(t(),o("img",{key:0,src:B||r(K)},null,8,te)):n("",!0)]),a("p",ae,u(k),1),g(O,{location:{city:S,country:E}},null,8,["location"])])],8,Y)]))),256))])]))]),_:1},8,["show"]))}},ne="?withoutEnlargement=true&quality=90&fit=cover&width=120",le=b.BASEURL+"items/Company?fields=*,social.*,owner.username&filter[name][_eq]=";async function ie(l){const e=le+l,c=await(await fetch(e)).json();if(c.data.length==0)throw"Can't find a profile for this company";const s={...c.data[0]};return s.logo=s?.logo?N(s.logo)+ne:null,s}const ce={key:0},ue={class:"row"},re={class:"text-center mb-3"},Ae=["src"],de={class:"my-3"},_e={key:1,class:"address mb-3"},ve={key:0},me={key:1},ye={key:2},fe={key:3},he=["href"],pe={key:3,class:"maintained mt-4 pt-3 border-top"},ge=["href"],we=["innerHTML"],h="col-12 col-sm-6 col-md-4",be={__name:"BusinessView",props:U({name:String},{name:"MyCompany"}),setup(l){const e=_(null),i=_(!1);let c;const s=["website","github","nuget","mastodon","pixelfed"];C(async()=>{i.value=!0,e.value=await ie(l.name),i.value=!1,c=F(e.value.description)}),w(()=>({city:e.value.location_city,country:e.value.location_country}));const d=w(()=>e.value.location_street||e.value.location_additionalInfo||e.value.location_postalcode||e.value.location_country||e.value.location_city);return(v,A)=>(t(),m(r($),{show:i.value},{default:p(()=>[e.value?(t(),o("div",ce,[a("div",ue,[a("div",{class:f(h)},[a("div",re,[e.value.logo?(t(),o("img",{key:0,src:e.value.logo,alt:"logo",class:"img-fluid"},null,8,Ae)):n("",!0),a("div",de,[a("h5",null,u(e.value.name),1)]),d.value?(t(),o("div",_e,[g(r(M),{class:"mb-2"},{default:p(()=>[g(r(Z))]),_:1}),e.value.location_street?(t(),o("div",ve,u(e.value.location_street),1)):n("",!0),e.value.location_additionalInfo?(t(),o("div",me,u(e.value.location_additionalInfo),1)):n("",!0),e.value.location_postalcode||e.value.location_city?(t(),o("div",ye,u(e.value.location_postalcode)+" "+u(e.value.location_city),1)):n("",!0),e.value.location_country?(t(),o("div",fe,u(r(T)(e.value.location_country)),1)):n("",!0)])):n("",!0),e.value.social.website||e.value.social.website!==""?(t(),o("a",{key:2,href:r(x)(e.value.social.website)},"Website",8,he)):n("",!0),e.value.owner?(t(),o("div",pe,[A[1]||(A[1]=V(" This page is maintained by:")),A[2]||(A[2]=a("br",null,null,-1)),a("a",{href:e.value.owner.username,onClick:A[0]||(A[0]=Q(y=>r(G)(e.value.owner.username),["prevent"]))},u(e.value.owner.username),9,ge)])):n("",!0)])]),a("div",{class:f(h)},[a("p",{innerHTML:r(c)},null,8,we)]),a("div",{class:f(h)},[e.value.social?(t(),m(q,{key:0,social:e.value.social,order:s},null,8,["social"])):n("",!0)])])])):n("",!0)]),_:1},8,["show"]))}},Ee={__name:"Businesses",setup(l){const e=H(),i=w(()=>e.query.company||null);return _(e.query.map),(c,s)=>i.value?(t(),m(be,{key:0,name:i.value},null,8,["name"])):(t(),m(oe,{key:1}))}};export{Ee as default};
