import{a4 as f,a5 as $,r as i,ae as v,ac as _,a2 as n,a9 as g,a1 as c,af as r,a3 as a,ag as u,H as k,aN as S,a8 as h,ah as y,ad as R,e as w,ai as E}from"./app.js";import{_ as F}from"./SocialView.js";import{c as U,g as x}from"./utils.js";const L=f.BASEURL+"items/Company?fields=*&sort=name&meta=filter_count",N="withoutEnlargement=true&fit=inside&height=50&quality=90&format=auto";function I(t){return t?`${f.ASSETS}${t}?${N}`:null}async function Q(t,e,l){try{const s=await(await fetch(L)).json();t.value=s.data,t.value.forEach(o=>{o.logo=I(o.logo)}),e.value=s.meta.filter_count,e.value>0&&l("setCount",e.value)}catch{console.log("error")}}const G="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFeXl5AAAAa7+IbgAAAFhJREFUeNrswQEBAAAAgJD+r+4ICgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFgAAQYAAQ8AAbQIco0AAAAASUVORK5CYII=",V={key:0,class:"businesses"},Z={class:"row"},q=["onClick"],D={class:"company"},M={class:"logo"},T=["src"],j={class:"name"},J={__name:"BusinessList",emits:["setCount"],setup(t,{emit:e}){const l=e,A=$(),s=i(null),o=i(0),m=i(!0);v(async()=>{m.value=!0,Q(s,o,l),m.value=!1});const B=d=>{A.push(`/user/businesses?company=${d}`)};return(d,ae)=>(n(),_(h(y),{show:m.value},{default:g(()=>[m.value?r("",!0):(n(),c("div",V,[a("p",null,"A list of "+u(o.value)+" businesses that use vvvv.",1),a("div",Z,[(n(!0),c(k,null,S(s.value,({name:p,description:C,logo:b})=>(n(),c("div",{"track-by":"name",class:"col-md-3 col-lg-4 py-3 border-bottom",onClick:ne=>B(p)},[a("div",D,[a("div",M,[d.profilepic!==null?(n(),c("img",{key:0,src:b||h(G)},null,8,T)):r("",!0)]),a("p",j,u(p),1),a("p",null,u(C),1)])],8,q))),256))])]))]),_:1},8,["show"]))}},O="?withoutEnlargement=true&quality=90&fit=cover&width=120",K=f.BASEURL+"items/Company?fields=*,social.*&filter[name][_eq]=";async function W(t,e){t.value=!0;const l=K+e;try{const s=await(await fetch(l)).json();if(s.data.length==0)throw"Can't find a profile for this company";const o={...s.data[0]};return o.logo=o?.logo?U(o.logo)+O:null,o}catch(A){console.error(A)}finally{t.value=!1}}const Y={key:0},H={class:"row"},P={class:"col-lg-4 text-center mb-3"},X=["src"],z={class:"my-3"},ee={key:1,class:"text-muted mb-4"},te={class:"text-muted mb-1"},se={class:"col-lg-8"},oe={__name:"BusinessView",props:R({name:String},{name:"MyCompany"}),setup(t){const e=i(null),l=i(!1),A=["website","github","nuget","mastodon","pixelfed"];v(async()=>{e.value=await W(l,t.name)});const s=w(()=>[e.value.location_city,x(e.value.location_country)].filter(Boolean).join(", ")??null);return(o,m)=>(n(),_(h(y),{show:l.value},{default:g(()=>[e.value?(n(),c("div",Y,[a("div",H,[a("div",P,[e.value.logo?(n(),c("img",{key:0,src:e.value.logo,alt:"logo",class:"img-fluid"},null,8,X)):r("",!0),a("div",z,[a("h5",null,u(e.value.name),1)]),s.value?(n(),c("p",ee,u(s.value),1)):r("",!0),a("p",te,u(e.value.description??""),1)]),a("div",se,[e.value.social?(n(),_(F,{key:0,social:e.value.social,order:A},null,8,["social"])):r("",!0)])])])):r("",!0)]),_:1},8,["show"]))}},re={__name:"Businesses",setup(t){const e=E(),l=w(()=>e.query.company||null);return i(e.query.map),(A,s)=>l.value?(n(),_(oe,{key:0,name:l.value},null,8,["name"])):(n(),_(J,{key:1}))}};export{re as default};
