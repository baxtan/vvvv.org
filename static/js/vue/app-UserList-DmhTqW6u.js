import{E as A,G as q,H as B,h as R,o as S,j as d,f as b,b as u,I as D,p as T,J as C,a as K,K as V,L as W,r as c,M as j,O as I,d as M,Q as H,R as O,w as h,u as G,g as m,T as x,U as J,V as Q,W as F,X,F as Y,Y as z,n as Z}from"./app-profile-DxpktdD5.js";const ee="sort=username",ae="fields[]=username,userpic,related.hire.available,date_created,location_city,location_country",te="?withoutEnlargement=true&quality=90&fit=cover&width=120&height=120";async function re(t){const o=se(t),r={data:null,totalPages:0,totalCount:0,currentPage:1},l=await(await fetch(o)).json(),a={year:"numeric",month:"short",day:"numeric"};return r.data=l.data?.map(s=>({src:s.userpic?q(s.userpic)+te:null,username:s.username,available:Array.isArray(s.related)?s.related[0]?.hire?.available??!1:!1,date_created:new Date(s.date_created).toLocaleString("en-US",a),location:A(s.location_city,s.location_country)})),r.totalCount=l.meta?.total_count??l.meta?.filter_count??t.totalCount??0,r.totalPages=Math.max(1,Math.ceil(r.totalCount/t.pageSize)),r}function se(t){const o=t.filter?`filter[username][_contains]=${t.filter}`:null,r=t.pageSize?`limit=${t.pageSize}&page=${t.currentPage}`:null,n=o?"meta=filter_count":"meta=total_count";let l="";if(t.sort?.order){const v=t.sort.order!="descend"?"-":"",g=t.sort.columnKey=="location"?"location_country,location_city":t.sort.columnKey;l="sort="+v+g}else l=ee;const s=[ae,l,o,r,n].filter(Boolean).join("&");return`${B.GET_USERS}?${s}`}const oe=["href"],ne={__name:"AvatarColumn",props:["src","username"],setup(t){return(o,r)=>(S(),R("a",{href:"/user/"+t.username,onClick:r[0]||(r[0]=n=>u(C)(t.username,n))},[d(u(T),{style:{cursor:"'pointer'"}},{default:b(()=>[d(u(D),{round:"",size:48,src:t.src,objectFit:"contain"},null,8,["src"])]),_:1})],8,oe))}},le={__name:"ForHireColumn",props:["value"],setup(t){const o=t;return(r,n)=>o.value?(S(),K(u(T),{key:0,color:"#0e7a0d",size:"20"},{default:b(()=>[d(u(W))]),_:1})):V("",!0)}},ie={class:"row mb-3"},ue={class:"col-12 mb-3 mb-md-0 col-md"},ce={class:"ml-3 ml-md-auto mr-3"},de={class:"overflow-auto"},pe={class:"row mt-3"},ge={class:"ml-auto"},fe={__name:"UserList",setup(t){const o=c(window.innerWidth),r=G(),n=M(),l=c(!1),a=j({currentPage:1,totalPages:0,totalCount:0,pageSize:10,filter:"",sort:null});I(()=>{if(n.query.u){C(n.query.u);return}window.addEventListener("resize",s),a.currentPage=Number(n.query.page)||1,l.value=!0}),H(()=>{window.removeEventListener("resize",s)});function s(){o.value=window.innerWidth}const p=[{label:"10 per page",value:10},{label:"20 per page",value:20},{label:"50 per page",value:50}],v=c({pageSize:p[0].value,pageSizes:p,page:1,showSizePicker:!0,pageCount:10}),g=c("");c(!1);function _(){a.currentPage=1,a.filter=g.value}const y=c(!1),k=e=>{a.currentPage=e},U=e=>{y.value=e<a.pageSize,a.pageSize=e,a.currentPage=1};function E(){a.filter=""}const L=c([]),w=c(!0),f=[{key:"avatar",width:60,render(e){return z(ne,{src:e.src,username:e.username})}},{title:"Username",key:"username",width:100,sorter:!0,ellipsis:!0,render(e){return z("a",{href:e.username,onClick:i=>C(e.username,i)},e.username)}},{title:"Location",key:"location",width:70,ellipsis:!0,sorter:!0},{title:"Available for Hire",key:"related.hire.available",width:60,ellipsis:!0,sorter:!0,render(e){return z(le,{value:e.available})}},{title:"Since",key:"date_created",width:70,ellipsis:!0,sorter:!0}],N=c(f);O(()=>a.sort,(e,i)=>{e!==i&&(a.currentPage=1)}),h(()=>{r.push({query:{...n.query,page:a.currentPage}})}),h(()=>{const e=o.value;N.value=e<600?f.slice(0,2):e<1024?f.slice(0,4):f}),h(()=>{g.value===""&&_()}),h(async()=>{l.value&&await $()});async function $(){try{w.value=!0;const e=await re(a);L.value=e.data,a.totalCount=e.totalCount,a.totalPages=e.totalPages,e.totalPages>0&&(v.value={pageSize:a.pageSize,pageSizes:p,page:a.currentPage,showSizePicker:!0,pageCount:e.totalPages||1}),y.value&&(window.scrollTo({top:0,behavior:"smooth"}),y.value=!1)}catch(e){console.log(e)}finally{w.value=!1}}return(e,i)=>(S(),R(Y,null,[m("div",ie,[m("div",ue,[d(u(J),{value:g.value,"onUpdate:value":i[0]||(i[0]=P=>g.value=P),type:"text",placeholder:"Username",style:{width:"10rem"},onClear:E,onKeyup:[x(_,["enter"]),x(E,["esc"])],clearable:""},null,8,["value"]),d(u(Q),{strong:"",secondary:"",onClick:_,class:"ml-xs-0 ml-2"},{default:b(()=>i[2]||(i[2]=[Z("Search")])),_:1})]),m("div",ce,[d(u(F),{page:a.currentPage,"page-count":a.totalPages,"page-sizes":p,"page-slot":5,"show-size-picker":"","on-update:page":k,"on-update:page-size":U},null,8,["page","page-count"])])]),m("div",de,[d(u(X),{loading:w.value,bordered:!1,columns:N.value,data:L.value,"onUpdate:sorter":i[1]||(i[1]=P=>a.sort=P),class:"userTable",style:{"white-space":"pre"}},null,8,["loading","columns","data"])]),m("div",pe,[m("div",ge,[d(u(F),{page:a.currentPage,"page-count":a.totalPages,"page-sizes":p,"page-slot":5,"show-size-picker":"","on-update:page":k,"on-update:page-size":U},null,8,["page","page-count"])])])],64))}};export{fe as default};
